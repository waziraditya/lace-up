<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Product â€” LaceUp</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* product page layout */
    .product-hero {
      max-width: 1200px;
      margin: 36px auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 36px;
      align-items: start;
    }
    .gallery {
      background: rgba(255,255,255,0.03);
      padding: 18px;
      border-radius: 14px;
    }
    .main-image {
      width: 100%;
      height: 420px;
      border-radius: 12px;
      object-fit: contain;
      background: #fff;
      padding: 18px;
    }
    .thumbs {
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .thumbs img {
      width:70px;
      height:70px;
      object-fit:cover;
      border-radius:8px;
      cursor:pointer;
      border:2px solid transparent;
    }
    .thumbs img.active { border-color: #ff6b35; }
    .details {
      background: rgba(255,255,255,0.03);
      padding: 22px;
      border-radius: 14px;
    }
    .brand { color: rgba(255,255,255,0.75); font-weight:700; margin-bottom:8px; }
    .price { font-size:1.6rem; color: #ff6b35; font-weight:900; margin-bottom:10px; }
    .rating { display:flex; gap:8px; align-items:center; color: #ffd166; margin-bottom:12px; }
    .selectors { display:flex; gap:16px; margin: 16px 0; flex-wrap:wrap; }
    .selectors select, .selectors input[type="number"] {
      padding:10px 12px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.03);
      color:#fff;
    }
    .actions { display:flex; gap:12px; margin-top:14px; }
    .btn-primary {
      background: linear-gradient(45deg,#ff6b35,#f7931e);
      color:#000;
      padding:12px 18px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:800;
      transition: transform 0.1s ease;
    }
    .btn-primary:active { transform: scale(0.97); }
    .btn-outline {
      background: transparent;
      border: 2px solid rgba(255,255,255,0.08);
      color:#fff;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      transition: transform 0.1s ease;
    }
    .btn-outline:active { transform: scale(0.97); }
    .section {
      max-width:1200px; margin: 30px auto; padding: 18px;
      border-radius: 12px; background: rgba(255,255,255,0.02);
    }
    .reviews .review { padding:12px; border-bottom:1px solid rgba(255,255,255,0.03); }
    .related { display:flex; gap:14px; overflow:auto; padding-bottom:6px; }
  </style>
</head>
<body>

  <header class="navbar" style="position:sticky; top:0; z-index:50;">
    <div style="display:flex; align-items:center; gap:18px;">
      <a href="index.html" style="color:white; text-decoration:none; font-weight:700;">â¬… Back to Shop</a>
      <div style="color: #ff6b35; font-weight:900; margin-left:18px;">Product Details</div>
    </div>
    <div>
      <span id="cart-count" style="background:#000; padding:6px 10px; border-radius:20px;">0</span>
    </div>
  </header>

  <main>
    <div id="product-root" class="product-hero"></div>

    <div class="section" id="descriptionSection">
      <h3>Description</h3>
      <p id="longDescription" class="small"></p>
    </div>

    <div class="section reviews" id="reviewsSection">
      <h3>Customer Reviews</h3>
      <div id="reviewsList"></div>
      
      <div style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
        <h4>Add Your Review</h4>
        <form id="reviewForm" style="display: flex; flex-direction: column; gap: 12px;">
          <input type="text" id="reviewerName" placeholder="Your Name" required style="padding: 10px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white;">
          <div style="display: flex; gap: 10px; align-items: center;">
            <label style="color: white;">Rating:</label>
            <select id="reviewRating" required style="padding: 8px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white;">
              <option value="5">5 Stars</option>
              <option value="4">4 Stars</option>
              <option value="3">3 Stars</option>
              <option value="2">2 Stars</option>
              <option value="1">1 Star</option>
            </select>
          </div>
          <textarea id="reviewText" placeholder="Write your review..." required rows="3" style="padding: 10px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; resize: vertical;"></textarea>
          <button type="submit" class="btn-primary" style="align-self: flex-start;">Submit Review</button>
        </form>
      </div>
    </div>

    <div class="section related-section">
      <h3>Related Products</h3>
      <div class="related" id="relatedList"></div>
    </div>
  </main>

  <script src="script.js"></script>
  <script>
    // Toast notification function
    function showToast(message, duration = 2500) {
      const toast = document.createElement('div');
      toast.style.cssText = `
        position: fixed; top: 20px; right: 20px; z-index: 1000;
        background: linear-gradient(45deg, #ff6b35, #f7931e);
        color: black; padding: 12px 20px; border-radius: 8px;
        font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        transform: translateX(100%); transition: transform 0.3s ease;
      `;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.style.transform = 'translateX(0)', 50);
      setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 300);
      }, duration);
    }
    const params = new URLSearchParams(window.location.search);
    const id = parseInt(params.get('id'), 10);
    const product = sneakerData.find(s => s.id === id);

    if (!product) {
      document.getElementById('product-root').innerHTML = '<div style="padding:40px; color:#fff;">Product not found. <a href="index.html">Go back</a></div>';
    } else {
      const images = product.images || [product.image, product.image, product.image];
      const sizes = product.sizes || ["6","7","8","9","10","11"];
      const colors = product.colors || ["White","Black","Grey"];
      const rating = product.rating || 4.4;
      const reviews = product.reviews || [
        { name: "Aanya", stars:5, text:"Great fit & fast delivery!" },
        { name: "Ravi", stars:4, text:"Comfortable but slightly narrow." }
      ];

      // Fill product details
      document.getElementById('product-root').innerHTML = `
        <div class="gallery">
          <img id="mainImg" class="main-image" src="${images[0]}" />
          <div class="thumbs">${images.map((img, i) =>
            `<img src="${img}" class="${i === 0 ? 'active':''}" onclick="document.getElementById('mainImg').src='${img}';document.querySelectorAll('.thumbs img').forEach(x=>x.classList.remove('active'));this.classList.add('active');" />`
          ).join('')}</div>
        </div>
        <div class="details">
          <div class="brand">${product.brand}</div>
          <h1>${product.title}</h1>
          <div class="rating">â˜… ${rating.toFixed(1)} <span class="small">â€¢ ${reviews.length} reviews</span></div>
          <div class="price">â‚¹${product.price.toLocaleString()}</div>
          <div class="selectors">
            <select id="sizeSelect">${sizes.map(s=>`<option value="${s}">${s}</option>`).join('')}</select>
            <select id="colorSelect">${colors.map(c=>`<option value="${c}">${c}</option>`).join('')}</select>
            <input id="qty" type="number" min="1" value="1" />
          </div>
          <div class="actions">
            <button id="addBtn" class="btn-primary">Add to Cart ðŸ›’</button>
            <button id="buyBtn" class="btn-outline">Buy Now</button>
          </div>
        </div>
      `;

      // Description
      document.getElementById('longDescription').innerText =
        product.longDescription || product.description || "Premium materials, comfortable cushioning and modern silhouette.";

      // Reviews - load from localStorage if available
      const storageKey = `reviews_${product.id}`;
      const savedReviews = JSON.parse(localStorage.getItem(storageKey)) || reviews;
      document.getElementById('reviewsList').innerHTML =
        savedReviews.map(r=>`<div class="review"><strong>${r.name}</strong> â˜… ${r.stars}<p>${r.text}</p></div>`).join('');

      // Related
      const relatedItems = sneakerData.filter(s => s.id !== product.id).slice(0,6);
      document.getElementById('relatedList').innerHTML =
        relatedItems.map(s=>`<a href="product.html?id=${s.id}" style="text-decoration:none;color:inherit;"><div><img src="${s.image}" style="width:160px;height:100px;object-fit:cover;border-radius:8px;" /><div>${s.title}</div><div style="color:#ff6b35;">â‚¹${s.price}</div></div></a>`).join('');

      // Add to Cart button
      document.getElementById('addBtn').addEventListener('click', function(e) {
        const size = document.getElementById('sizeSelect').value;
        const color = document.getElementById('colorSelect').value;
        const qty = parseInt(document.getElementById('qty').value, 10) || 1;
        addToCart(e, product.id, { size, color, qty });
      });

      // Buy Now button - direct checkout without adding to cart
      document.getElementById('buyBtn').addEventListener('click', function() {
        const size = document.getElementById('sizeSelect').value;
        const color = document.getElementById('colorSelect').value;
        const qty = parseInt(document.getElementById('qty').value, 10) || 1;
        
        // Create temporary checkout item
        const checkoutItem = {
          id: product.id,
          title: product.title,
          brand: product.brand,
          price: product.price,
          size: size,
          color: color,
          qty: qty,
          image: images[0]
        };
        
        // Store for checkout
        localStorage.setItem('directCheckout', JSON.stringify([checkoutItem]));
        
        // Redirect directly to checkout
        window.location.href = 'checkout.html?direct=true';
      });
      
      // Review form submission
      document.getElementById('reviewForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('reviewerName').value.trim();
        const rating = parseInt(document.getElementById('reviewRating').value);
        const text = document.getElementById('reviewText').value.trim();
        
        if (!name || !text) return;
        
        // Get existing reviews from localStorage or use default
        const storageKey = `reviews_${product.id}`;
        let productReviews = JSON.parse(localStorage.getItem(storageKey)) || reviews;
        
        // Add new review
        const newReview = { name, stars: rating, text };
        productReviews.unshift(newReview);
        
        // Save to localStorage
        localStorage.setItem(storageKey, JSON.stringify(productReviews));
        
        // Update display
        document.getElementById('reviewsList').innerHTML = 
          productReviews.map(r=>`<div class="review"><strong>${r.name}</strong> â˜… ${r.stars}<p>${r.text}</p></div>`).join('');
        
        // Reset form
        document.getElementById('reviewForm').reset();
        
        // Show success message
        if (typeof showToast === 'function') {
          showToast('Review added successfully! âœ“', 2000);
        }
      });

      // Update cart count
      updateCartCount();
    }
  </script>
</body>
</html>
